---
import { getCollection, getEntryBySlug } from 'astro:content';

// âœ… getStaticPaths() ã®å®šç¾©
export async function getStaticPaths() {
  // "projects" ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
  const projects = await getCollection('projects');

  return projects.map((project) => ({
    params: { slug: project.slug }, // âœ… å„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¹ãƒ©ã‚°ã‚’æŒ‡å®š
    props: { project: project.data }, // âœ… å„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™
  }));
}

// âœ… URLã®ã‚¹ãƒ©ã‚°ã‚’å–å¾—
const { slug } = Astro.params;

// âœ… ã‚¹ãƒ©ã‚°ã«å¯¾å¿œã™ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
const project = await getEntryBySlug('projects', slug);

if (!project) {
  throw new Error(`ğŸš¨ Project "${slug}" not found`);
}

// âœ… ç”»åƒãƒªã‚¹ãƒˆã‚’ä½œæˆ
const images = [
  `/photo/${slug}/01.jpeg`,
  `/photo/${slug}/02.jpeg`,
  `/photo/${slug}/03.jpeg`
];
---

<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{project?.data?.title || "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè©³ç´°"}</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <header>
      <h1>{project?.data?.title}</h1>
    </header>

    <main>
      <p class="project-caption">{project?.data?.caption || "ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã¾ã›ã‚“"}</p> 

      <div class="image-gallery">
        {images.map((image) => (
          <img src={image} alt={project?.data?.title} />
        ))}
      </div>

      <a href="/">â† ãƒ›ãƒ¼ãƒ ã¸æˆ»ã‚‹</a>
    </main>
</body>
</html>
